cmake_minimum_required(VERSION 3.18 FATAL_ERROR)
project(video_scene_detector)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find required packages
find_package(OpenCV REQUIRED)
find_package(Threads REQUIRED)

# Find CUDA
find_package(CUDA REQUIRED)

# Include directories
include_directories(${OpenCV_INCLUDE_DIRS})
include_directories(/home/ilya/Projects/TrackNetV3/dinov3/.dinov3/lib/python3.10/site-packages/torch/include)
include_directories(/home/ilya/Projects/TrackNetV3/dinov3/.dinov3/lib/python3.10/site-packages/torch/include/torch/csrc/api/include)

# Link directories
link_directories(/home/ilya/Projects/TrackNetV3/dinov3/.dinov3/lib/python3.10/site-packages/torch/lib)

# Create executable
add_executable(video_scene_detector video_scene_detector.cc)

# Link libraries
target_link_libraries(video_scene_detector
    ${OpenCV_LIBS}
    Threads::Threads
    torch
    torch_cpu
    torch_cuda
    c10
    c10_cuda
    cudart
    cublas
    curand
    cusparse
    cufft
    cusolver
    cudnn
    nvrtc
    nvtx
)

# Set RPATH
set_target_properties(video_scene_detector PROPERTIES
    INSTALL_RPATH_USE_LINK_PATH TRUE
    INSTALL_RPATH "/home/ilya/Projects/TrackNetV3/dinov3/.dinov3/lib/python3.10/site-packages/torch/lib"
)

